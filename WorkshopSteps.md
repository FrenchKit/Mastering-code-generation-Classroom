# Workshop steps

> Prep TODOs
> 
>  - Add a Localizable.stringdict and mention the need for having the key in .strings anyway
>  - Squash the existing commits then undo the steps for Step 0, re-spreading them in separate commits
>    - remove some fonts from Info.plist to demonstrate case when we forgot
>    - Remove lots of data from the ItemStore (to make it as if typed by hand)
>    - Introduce some more intentional bugs (wrong image name, wrong string key)
>    - remove tools from Pods [extract in separate commit]
>    - Remove Lottie.stencil [extract in separate commit]
>  - Review the code, ensure it's organized correctly (folders, etc), and no FIXME missing
>  - Review the Stages and Steps listed below before starting, and compare with the FIXMEs. Add Stage number in FIXME messages
>  - Play the steps below and create the individual commits
> 
> - Update `README.md` with this content
> - Slides for presentation talk
> 

## Exercices

### Stage 0: Discover the project

* Compile and launch the project in Xcode
* Browse the source code quickly
* Identify the issues with hardcoded values:
  * L10n missing, wrong keys
  * Images missing, wrong keys
  * Fonts: wrong name, need to declare them in Info.plist, ...
  * Storyboards: hardcoded SB and Scene names
  * Data: Lots to type by hand -> yaml
  * Info.plist : hardcoded keys
  * Lottie: hardcoded name
* Identify the annoying repetition of code
  * Equatable implementations for enums
  * Big switch just to identify a name property
  * Image associated with Item should be derived from item case
  * ...

### Stage 1: SwiftGen and Build-in templates

* Install SwiftGen via CocoaPods
* Fix L10n
* Fix images
* Fix Fonts â€“ Don't forget to remove them from the Info.plist too!
* Fix Storyboards
* Fix Info.plist

### Stage 2: Custom Template

* Discover Stencil doc
* Use a dummy custom template to list all Storyboads and their scene in the project
* Re-create Lottie template, add generated code to Xcode, replace call site

### Stage 3: Discover Sourcery

* Install Sourcery
* Use AutoEquatable Template

### Stage 4: Custom Templates with Sourcery

* Create Custom template listing all `Model` types. Use the `--watch` mode
* Make the template evolve to re-generate the `enum Item`
* Add the generation of the `image` property and the `Encodable` conformance
* Add a custom annotation to identify the name property and generate the `var name` from it

### Stage 5: Generate all fields for all items

* Make `ItemFields.swift` be generated by Sourcery
* Use a custom annotation to exclude the openingCrawl property from the fields
* Make `ItemStore + subscripts` be generated by Sourcery

### Stage 6: Add and rename models

* Add planets to the `swiftgen.yml` to generate their model
* This should show in how many places we depend on Item cases
* Rename `enum Film` to `enum Movie` and ensure everything changes

### Stage 6: Bonus

* Custom Encodable for Models, mark some properties to be ignored
* Show Sourcery EnumValue template
